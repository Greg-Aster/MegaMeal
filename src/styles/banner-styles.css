@tailwind components;

@layer components {
    /* ===================================================================
     * BANNER CORE SYSTEM - SIMPLIFIED & DRY
     * ===================================================================
     */
    
    /* ðŸŽ¯ SINGLE SOURCE: Banner dimensions from config */
    :root {

    /* ðŸŽ¯ NEW: Dynamic overlap system */
        --banner-overlap-home: 10rem;
        --banner-overlap-posts: 2.5rem;
        --banner-overlap-other: 4rem;
        --banner-overlap-current: var(--banner-overlap-other); /* Default */
        
        /* Only keep timing/animation properties that aren't standard Tailwind */
        --banner-transition-duration: 0.4s;
        --banner-transition-easing: cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* ðŸŽ¯ UNIFIED CONTAINER SYSTEM */
    .banner-container-base {
        @apply w-full overflow-hidden mx-auto;
        max-width: var(--banner-max-width);
        padding-left: var(--banner-padding);
        padding-right: var(--banner-padding);
    }

    .banner-aspect-container {
        @apply relative w-full overflow-hidden shadow-lg;
        padding-bottom: var(--banner-aspect-ratio);
        border-radius: var(--banner-border-radius);
    }

    .banner-content-wrapper {
        @apply absolute inset-0 w-full h-full;
    }

    /* Banner type containers */
    .banner-container-standard { @apply banner-container-base; }
    .banner-container-video { @apply banner-container-base; }
    .banner-container-timeline { @apply banner-container-base; }
    .banner-container-assistant { @apply banner-container-base; }
    .banner-container-image { @apply banner-container-base; }

    /* ===================================================================
     * BANNER SLIDES - SIMPLIFIED
     * ===================================================================
     */
    
    /* âœ… FIXED - Fill parent container */
    #standard-banner-container {
        @apply relative overflow-hidden w-full h-full;
        /* No min-height constraint - let it fill the parent */
    }

    .banner-slide {
        @apply absolute inset-0 w-full h-full transition-opacity;
        transition-duration: var(--banner-transition-duration);
        transition-timing-function: var(--banner-transition-easing);
        will-change: opacity;
        backface-visibility: hidden;
    }

    .banner-image,
    .banner-video {
        @apply block w-full h-full object-cover transition-transform duration-300;
        will-change: transform;
    }

    /* ===================================================================
     * INTERACTION STATES - USING TAILWIND Z-INDEX
     * ===================================================================
     */
    
    .banner-slide.banner-interactive {
        @apply pointer-events-auto z-10;
    }

    .banner-slide.banner-non-interactive {
        @apply pointer-events-none z-0;
    }

    .banner-slide.banner-paused {
        @apply z-20;
        transform: scale(1.002);
    }

    .banner-slide.banner-selected {
        @apply z-30 pointer-events-auto;
        transform: scale(1.01);
    }

    .banner-slide.banner-hover .banner-link {
        transform: scale(1.02);
        transition: transform 0.2s ease-out;
    }

    .banner-link {
        @apply relative w-full h-full cursor-pointer transition z-20;
    }

    /* ===================================================================
     * PREVIEW OVERLAY - SIMPLIFIED
     * ===================================================================
     */
    
    .banner-postcard-preview {
        @apply absolute inset-0 w-full h-full flex flex-col items-center justify-center p-12 z-30;
        backdrop-filter: blur(8px);
        
        /* States */
        opacity: 0;
        transform: translateY(10px);
        visibility: hidden;
        pointer-events: none;
        transition: all var(--banner-transition-duration) var(--banner-transition-easing);
    }

    .banner-postcard-preview.banner-preview-visible {
        @apply opacity-100 pointer-events-auto visible;
        transform: translateY(0);
    }

    .banner-postcard-preview.banner-preview-hidden {
        @apply opacity-0 pointer-events-none invisible;
        transform: translateY(10px);
    }

    .banner-preview-card {
        @apply max-w-[80%] min-w-[300px] transition-transform;
        transform: scale(0.95);
        transition-duration: var(--banner-transition-duration);
    }

    .banner-postcard-preview.banner-preview-visible .banner-preview-card {
        transform: scale(1);
    }

    /* ===================================================================
     * NAVIGATION & CONTROLS - SIMPLIFIED
     * ===================================================================
     */
    
    .banner-navigation-controls {
        @apply absolute inset-y-1/2 left-0 right-0 flex justify-between items-center px-4 z-40;
        transform: translateY(-50%);
        opacity: 0;
        pointer-events: none;
        transition: all 0.3s ease;
    }

    .banner-postcard-preview.banner-preview-visible .banner-navigation-controls {
        @apply opacity-100 pointer-events-auto;
    }

    .banner-nav-btn {
        @apply flex items-center justify-center w-12 h-12 md:w-12 md:h-12 rounded-full border transition-all duration-200 cursor-pointer opacity-90;
        backdrop-filter: blur(8px);
    }

    .banner-nav-btn:hover {
        @apply opacity-100 scale-110;
    }

    .banner-nav-btn:active {
        @apply scale-95;
    }

    .banner-nav-icon {
        @apply w-5 h-5 transition-transform duration-200;
    }

    .banner-nav-btn:hover .banner-nav-icon {
        @apply scale-110;
    }

    /* Position indicators */
    .banner-position-indicator {
        @apply absolute bottom-4 left-1/2 flex gap-2 z-40;
        transform: translateX(-50%);
        opacity: 0;
        pointer-events: none;
        transition: all 0.3s ease;
    }

    .banner-postcard-preview.banner-preview-visible .banner-position-indicator {
        @apply opacity-100 pointer-events-auto;
    }

    .banner-position-dot {
        @apply w-2 h-2 md:w-2 md:h-2 rounded-full bg-black/40 dark:bg-white/40 transition-all duration-200 cursor-pointer;
    }

    .banner-position-dot.active {
        background-color: var(--primary);
        transform: scale(1.2);
        box-shadow: 0 0 8px color-mix(in srgb, var(--primary) 60%, transparent);
    }

    /* ===================================================================
     * INTERACTION INDICATORS - SIMPLIFIED
     * ===================================================================
     */
    
    .banner-click-indicator {
        @apply absolute top-4 right-4 bg-black/70 text-white px-3 py-2 rounded-lg text-xs flex items-center opacity-80 transition-opacity duration-300 pointer-events-none z-20;
    }

    .banner-slide:hover .banner-click-indicator {
        @apply opacity-100 bg-black/90;
    }

    .banner-preview-close {
        @apply absolute top-4 right-4 bg-black/70 text-white border-0 w-8 h-8 rounded-full flex items-center justify-center cursor-pointer transition-all duration-200 z-30;
    }

    .banner-preview-close:hover {
        @apply bg-black/90 scale-110;
    }

    .banner-pause-indicator {
        @apply absolute top-4 left-4 bg-orange-500/90 text-white rounded-full w-8 h-8 hidden items-center justify-center text-xs z-40;
        backdrop-filter: blur(4px);
        box-shadow: 0 2px 8px rgba(255, 165, 0, 0.3);
        transition: all 0.3s ease;
    }

    .banner-slide.banner-paused .banner-pause-indicator {
        @apply flex;
        animation: pausePulse 2s infinite ease-in-out;
    }

    @keyframes pausePulse {
        0%, 100% { 
            opacity: 1; 
            transform: scale(1); 
        }
        50% { 
            opacity: 0.7; 
            transform: scale(1.05); 
        }
    }

    /* ===================================================================
     * LOADING INDICATOR - SIMPLIFIED
     * ===================================================================
     */
    
    .banner-loading-indicator {
        @apply absolute top-1/2 left-1/2 flex items-center gap-3 px-6 py-4 rounded-xl border pointer-events-none z-50;
        transform: translate(-50%, -50%) scale(0.9);
        backdrop-filter: blur(8px);
        background: color-mix(in srgb, black 85%, transparent);
        opacity: 0;
        transition: all 0.3s ease;
    }

    .banner-loading-indicator[style*="flex"] {
        @apply opacity-100;
        transform: translate(-50%, -50%) scale(1);
    }

    .loading-spinner {
        @apply w-5 h-5 border-2 border-white/30 rounded-full flex-shrink-0;
        border-top-color: var(--primary);
        animation: bannerSpinnerRotate 1s linear infinite;
    }

    .loading-text {
        @apply text-sm font-medium whitespace-nowrap opacity-90;
    }

    @keyframes bannerSpinnerRotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* ===================================================================
     * RESPONSIVE - SINGLE SYSTEM
     * ===================================================================
     */
    
    @media (max-width: 640px) {
        .banner-click-indicator {
            @apply top-2 right-2 px-2 py-1.5 text-[0.625rem];
        }
        
        .banner-preview-close {
            @apply top-2 right-2 w-7 h-7;
        }
        
        .banner-postcard-preview {
            @apply p-6;
        }
        
        .banner-pause-indicator {
            @apply top-2 left-2 w-7 h-7;
        }

        .banner-nav-btn {
            @apply w-10 h-10;
        }

        .banner-position-dot {
            @apply w-1.5 h-1.5;
        }
    }

    @media (min-width: 769px) {
        .banner-slide.banner-interactive .banner-link:hover .banner-image,
        .banner-slide.banner-interactive .banner-link:hover .banner-video {
            @apply scale-[1.02];
        }

        .banner-slide.banner-interactive .banner-link:hover {
            border-radius: inherit;
            box-shadow: 
                0 0 0 3px color-mix(in srgb, var(--primary) 30%, transparent),
                0 0 20px color-mix(in srgb, var(--primary) 20%, transparent);
        }
    }

    /* ===================================================================
     * ACCESSIBILITY & REDUCED MOTION
     * ===================================================================
     */
    
    .banner-link:focus,
    .banner-link:focus-visible {
        outline: 4px solid var(--primary);
        outline-offset: 4px;
        border-radius: inherit;
    }

    @media (prefers-reduced-motion: reduce) {
        .banner-slide,
        .banner-image,
        .banner-video,
        .banner-postcard-preview,
        .banner-pause-indicator,
        .banner-navigation-controls,
        .banner-nav-btn,
        .banner-position-indicator,
        .banner-position-dot,
        .banner-loading-indicator,
        .loading-spinner {
            transition: none !important;
            animation: none !important;
        }
    }

    /* ===================================================================
     * FULLSCREEN MODE - PRESERVED
     * ===================================================================
     */
    
    @media (min-width: 1024px) {
        body.force-mobile-view {
            --page-width: 95vw;
        }
        
        body.force-mobile-view #main-panel-wrapper {
            @apply top-0 max-w-full p-0;
        }

        body.force-mobile-view #main-grid {
            @apply grid-cols-1 grid-rows-[auto_1fr_auto] mt-[5.5rem] max-w-full px-8;
        }
        
        body.force-mobile-view #top-row {
            @apply max-w-full p-0;
        }
        
        body.force-mobile-view #navbar-wrapper .card-base {
            @apply max-w-full m-0 rounded-none;
        }
        
        body.force-mobile-view .sidebar,
        body.force-mobile-view [class*="lg:col-span-1"]:first-child {
            @apply hidden;
        }
        
        body.force-mobile-view main#main {
            @apply col-span-2 max-w-full;
        }
        
        body.force-mobile-view #toc-wrapper,
        body.force-mobile-view [class*="2xl:block"] {
            @apply hidden;
        }
    }

    body.force-mobile-view #banner-container {
        @apply hidden;
    }
}

/* ===================================================================
 * OUTSIDE @layer - PRESERVED COMPATIBILITY
 * ===================================================================
 */

.banner-pause-indicator {
  position: absolute;
  top: 1rem;
  left: 1rem;
  background: rgba(255, 165, 0, 0.9);
  color: white;
  border-radius: 50%;
  width: 2rem;
  height: 2rem;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 60;
}

.banner-slide.banner-paused .banner-pause-indicator {
  display: flex !important;
  animation: pulse 2s infinite;
}